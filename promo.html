<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VSV Easy Shop â€” Promotions Management</title>
  <!-- Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root{
      --bg: #0b1220;
      --card: #11182a;
      --muted: #9aa4b2;
      --text: #e6e9ef;
      --brand: #6c8cff;
      --brand-2: #15c39a;
      --accent: #f59f00;
      --danger: #ff6b6b;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --radius: 16px;
    }
    /* Light theme */
    :root.light{
      --bg:#f6f7fb; --card:#ffffff; --muted:#6b7280; --text:#0f172a; --brand:#4f46e5; --brand-2:#059669; --accent:#d97706; --danger:#dc2626; --shadow:0 8px 20px rgba(2,6,23,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto; background:var(--bg); color:var(--text); display:flex;
    }

    /* Layout */
    .sidebar{
      width:280px; background:linear-gradient(180deg, #0e172a 0%, #0b1220 100%);
      border-right:1px solid rgba(255,255,255,.06); padding:20px; position:sticky; top:0; height:100vh; overflow:auto;
    }
    .brand{display:flex; align-items:center; gap:12px; font-weight:700; font-size:15px; letter-spacing:.2px;}
    .brand .logo{display:grid; place-items:center; width:38px; height:38px; border-radius:12px; background:linear-gradient(135deg, var(--brand), var(--brand-2)); box-shadow:var(--shadow)}

    .nav{margin-top:24px}
    .nav h4{font-size:12px; text-transform:uppercase; letter-spacing:.14em; color:var(--muted); margin:14px 12px}
    .nav a{
      display:flex; align-items:center; gap:12px; padding:12px 14px; border-radius:12px; text-decoration:none; color:var(--text);
      transition:.2s background;
    }
    .nav a:hover{background:rgba(255,255,255,.06)}
    .nav a.active{background:linear-gradient(90deg, rgba(108,140,255,.18), transparent); border:1px solid rgba(108,140,255,.35)}
    .nav .badge{margin-left:auto; font-size:12px; color:#fff; background:var(--danger); padding:2px 8px; border-radius:999px}

    .main{
      flex:1; display:flex; flex-direction:column; min-width:0;
    }
    .topbar{
      position:sticky; top:0; z-index:10; background:rgba(17,24,42,.75); backdrop-filter: blur(10px); border-bottom:1px solid rgba(255,255,255,.06);
      display:flex; align-items:center; gap:12px; padding:14px 20px;
    }
    :root.light .topbar{background:rgba(255,255,255,.8)}

    .search{
      display:flex; align-items:center; gap:10px; background:var(--card); border:1px solid rgba(255,255,255,.08); border-radius:999px; padding:10px 14px; flex:1;
    }
    .search input{
      background:transparent; 
      border:none; 
      outline:none; 
      color:var(--text); 
      width:100%;
      font-size: 13px;
    }

    .top-actions{display:flex; align-items:center; gap:10px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:var(--card); color:var(--text); cursor:pointer}
    .btn:hover{filter:brightness(1.05)}
    .avatar{width:36px; height:36px; border-radius:999px; background:linear-gradient(135deg,#22d3ee,#6366f1); display:grid; place-items:center; font-weight:700}

    .content{padding:20px; display:grid; gap:18px}

    /* KPI cards */
    .grid{display:grid; gap:18px}
    .grid.kpi{grid-template-columns: repeat(4, minmax(220px, 1fr))}
    @media (max-width:1100px){.grid.kpi{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:640px){.grid.kpi{grid-template-columns:1fr}}

    .card{background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); box-shadow:var(--shadow); padding:16px}
    .card h3{margin:0 0 6px; font-size:15px; color:var(--muted); font-weight:600}
    .card .value{font-size:28px; font-weight:700}
    .trend{display:flex; align-items:center; gap:8px; font-size:13px}
    .trend.up{color:var(--brand-2)}
    .trend.down{color:var(--danger)}

    /* Promotions Management Styles */
    .promotions-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .promotions-actions {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .add-promo-btn {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      border: none;
      color: white;
      padding: 12px 20px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
    }

    .promotions-filters {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filter-select {
      background: var(--card);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 6px;
      padding: 8px 12px;
      color: var(--text);
      min-width: 150px;
      font-size: 13px;
    }

    /* Tables */
    table{width:100%; border-collapse:collapse; font-size:14px}
    th, td{padding:12px 10px; border-bottom:1px solid rgba(255,255,255,.06)}
    th{text-align:left; color:var(--muted); font-weight:600; font-size:12px; letter-spacing:.04em; text-transform:uppercase}
    tr:hover td{background:rgba(255,255,255,.03)}
    .status{padding:4px 10px; border-radius:999px; font-size:12px;}
    .st-active{background:rgba(21,195,154,.15); color:var(--brand-2)}
    .st-inactive{background:rgba(108,140,255,.15); color:var(--brand)}
    .st-new{background:rgba(245,159,0,.15); color:var(--accent)}

    .action-btn {
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 12px;
      margin-right: 5px;
    }

    .edit-btn {
      background: rgba(108,140,255,.15);
      color: var(--brand);
    }

    .delete-btn {
      background: rgba(255,107,107,.15);
      color: var(--danger);
    }

    .view-btn {
      background: rgba(21,195,154,.15);
      color: var(--brand-2);
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,.5);
      backdrop-filter: blur(5px);
      z-index: 1000;
    }

    .modal-content {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      max-width: 500px;
      margin: 80px auto;
      box-shadow: var(--shadow);
      max-height: 70vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .modal-close {
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 20px;
    }

    .form-group {
      margin-bottom: 10px;
    }

    .form-label {
      display: block;
      margin-bottom: 6px;
      color: var(--muted);
      font-size: 14px;
    }

    .form-input {
      width: 100%;
      padding: 8px;
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 6px;
      background: var(--bg);
      color: var(--text);
      font-size: 13px;
    }

    .form-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 16px;
    }

    /* Footer */
    .footer{padding:20px; color:var(--muted); font-size:13px}

    /* Toggle + collapse */
    .toggle{display:none}
    @media (max-width:960px){
      .sidebar{position:fixed; left:0; top:0; transform:translateX(-100%); transition:.2s transform; z-index:30}
      .sidebar.open{transform:translateX(0)}
      .toggle{display:inline-flex}
      body.nav-open::after{content:""; position:fixed; inset:0; backdrop-filter:blur(2px); background:rgba(0,0,0,.35);}
    }

    .toggle-icon {
      margin-left: auto;
      font-size: 0.75em;
      color: var(--muted);
      transition: transform 0.3s ease;
    }

    /* Additional styles for promotions */
    .promo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
    }
    .promo-card {
      background: var(--card);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: var(--radius);
      padding: 16px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .promo-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow);
    }
    .promo-card h3 { margin-top: 0; }
    .past-promo {
      background: #2d3748;
      border: 1px dashed var(--danger);
    }
    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
    }
    .badge-active { background: var(--brand-2); color: #fff; }
    .badge-past { background: var(--danger); color: #fff; }

    button {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-right: 5px;
    }
    .btn-add { background: var(--brand); color: white; }
    .btn-add:hover { background: var(--brand); filter: brightness(1.1); }
    .btn-edit { background: var(--brand); color: white; }
    .btn-edit:hover { background: var(--brand); filter: brightness(1.1); }
    .btn-delete { background: var(--danger); color: white; }
    .btn-delete:hover { background: var(--danger); filter: brightness(1.1); }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="brand">
      <div class="logo"><i class="fa-solid fa-bag-shopping"></i></div>
      <h1><a href="homepage.html" style="text-decoration: none; color: inherit;">VSV Shop Easy</a></h1>
    </div>

    <nav class="nav">
      <h4>Menu</h4>
      <a href="dashboard.html"><i class="fa-solid fa-chart-line"></i>Dashboard <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="orders.html"><i class="fa-solid fa-clipboard-list"></i>Orders <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="dashboard-products.html"><i class="fa-solid fa-box"></i>Products <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="dashboard-customers.html"><i class="fa-solid fa-users"></i>Customers <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="inventory-dashboard.html"><i class="fa-solid fa-warehouse"></i>Inventory <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="promo.html" class="active"><i class="fa-solid fa-percent"></i>Promotions <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="reports.html"><i class="fa-solid fa-chart-pie"></i>Reports <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <h4>Settings</h4>
      <a href="store-settings.html"><i class="fa-solid fa-gear"></i>Store Settings <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
      <a href="dashboard-login.html"><i class="fa-solid fa-right-from-bracket"></i>Logout <i class="fa-solid fa-chevron-right toggle-icon"></i></a>
    </nav>
  </aside>

  <!-- Main -->
  <main class="main">
    <!-- Topbar -->
    <div class="topbar">
      <button class="btn toggle" id="navToggle"><i class="fa-solid fa-bars"></i></button>
      <div class="search">
        <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
        <input placeholder="Search promotions..." id="promoSearch" />
      </div>
      <div class="top-actions">
        <button class="btn" id="themeToggle" title="Toggle theme"><i class="fa-solid fa-moon"></i></button>
        <button class="btn"><i class="fa-regular fa-bell"></i></button>
        <div class="avatar">VL</div>
      </div>
    </div>

    <!-- Content -->
    <div class="content">
      <!-- Promotions Overview KPIs -->
      <section class="grid kpi">
        <article class="card">
          <h3>Active Promotions</h3>
          <div class="value" id="activePromos">5</div>
          <div class="trend up"><i class="fa-solid fa-arrow-up"></i> +2 new this month</div>
        </article>
        <article class="card">
          <h3>Total Discount Given</h3>
          <div class="value" id="totalDiscount">â‚¹25,000</div>
          <div class="trend up"><i class="fa-solid fa-rupee-sign"></i> +15% from last month</div>
        </article>
        <article class="card">
          <h3>Promotion Reach</h3>
          <div class="value" id="promoReach">1,250</div>
          <div class="trend up"><i class="fa-solid fa-users"></i> Customers engaged</div>
        </article>
        <article class="card">
          <h3>Conversion Rate</h3>
          <div class="value" id="conversionRate">12%</div>
          <div class="trend down"><i class="fa-solid fa-chart-line"></i> -2% from last month</div>
        </article>
      </section>

      <!-- Promotions Management Header -->
      <section class="card">
        <div class="promotions-header">
          <h2>Promotion Management</h2>
          <div class="promotions-actions">
            <div class="promotions-filters">
              <select class="filter-select" id="statusFilter">
                <option value="all">All Status</option>
                <option value="active">Active</option>
                <option value="ended">Ended</option>
              </select>
              <select class="filter-select" id="sortFilter">
                <option value="name">Name A-Z</option>
                <option value="date">Date Added</option>
                <option value="discount">Discount Amount</option>
              </select>
            </div>
            <button class="add-promo-btn" onclick="openAddPromoModal()">
              <i class="fa-solid fa-plus"></i> Add Promotion
            </button>
          </div>
        </div>
      </section>

      <!-- Active Promotions -->
      <section class="card">
        <h2>Active Promotions</h2>
        <div class="promo-grid">
          <div class="promo-card"><h3>Diwali Dhamaka <span class="badge badge-active">Active</span></h3><p>Flat 25% off all products</p><p>Valid: Oct 20 - Oct 30</p><button class="btn-edit" onclick="openEditModal('Diwali Dhamaka')">Edit</button><button class="btn-delete" onclick="confirmDelete('Diwali Dhamaka')">Delete</button></div>
          <div class="promo-card"><h3>Weekend Offer <span class="badge badge-active">Active</span></h3><p>Buy 1 Get 1 Free</p><p>Valid: Sep 2 - Sep 4</p><button class="btn-edit" onclick="openEditModal('Weekend Offer')">Edit</button><button class="btn-delete" onclick="confirmDelete('Weekend Offer')">Delete</button></div>
          <div class="promo-card"><h3>Festive Combo <span class="badge badge-active">Active</span></h3><p>Extra â‚¹1000 off on orders above â‚¹5000</p><p>Valid: Sep 10 - Sep 20</p><button class="btn-edit" onclick="openEditModal('Festive Combo')">Edit</button><button class="btn-delete" onclick="confirmDelete('Festive Combo')">Delete</button></div>
          <div class="promo-card"><h3>Flash Sale <span class="badge badge-active">Active</span></h3><p>50% off on electronics</p><p>Valid: Aug 30 - Sep 1</p><button class="btn-edit" onclick="openEditModal('Flash Sale')">Edit</button><button class="btn-delete" onclick="confirmDelete('Flash Sale')">Delete</button></div>
          <div class="promo-card"><h3>Back to School <span class="badge badge-active">Active</span></h3><p>20% off on stationery</p><p>Valid: Aug 15 - Aug 31</p><button class="btn-edit" onclick="openEditModal('Back to School')">Edit</button><button class="btn-delete" onclick="confirmDelete('Back to School')">Delete</button></div>
        </div>
      </section>

      <!-- Past Promotions -->
      <section class="card">
        <h2>Past Promotions</h2>
        <div class="promo-grid">
          <div class="promo-card past-promo"><h3>Summer Sale <span class="badge badge-past">Ended</span></h3><p>Upto 50% off summer collection</p><p>Ended: July 15</p></div>
          <div class="promo-card past-promo"><h3>Independence Day Special <span class="badge badge-past">Ended</span></h3><p>â‚¹500 off above â‚¹5000</p><p>Ended: Aug 15</p></div>
          <div class="promo-card past-promo"><h3>Monsoon Discount <span class="badge badge-past">Ended</span></h3><p>30% off on rainwear</p><p>Ended: Aug 5</p></div>
          <div class="promo-card past-promo"><h3>Clearance Sale <span class="badge badge-past">Ended</span></h3><p>Flat 70% off old stock</p><p>Ended: June 30</p></div>
          <div class="promo-card past-promo"><h3>Fatherâ€™s Day Offer <span class="badge badge-past">Ended</span></h3><p>Buy 2 Get 1 Free</p><p>Ended: June 16</p></div>
        </div>
      </section>

      <div class="footer">Â© 2025 VSV Easy Shop â€¢ Promotions Management</div>
    </div>
  </main>

  <!-- Add Promotion Modal -->
  <div class="modal" id="addPromoModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add New Promotion</h3>
        <button class="modal-close" onclick="closeAddPromoModal()">&times;</button>
      </div>
      <form id="addPromoForm">
        <div class="form-group">
          <label class="form-label">Promotion Title</label>
          <input type="text" class="form-input" name="title" required>
        </div>
        <div class="form-group">
          <label class="form-label">Discount (%)</label>
          <input type="number" class="form-input" name="discount" min="0" max="100" required>
        </div>
        <div class="form-group">
          <label class="form-label">Start Date</label>
          <input type="date" class="form-input" name="startDate" required>
        </div>
        <div class="form-group">
          <label class="form-label">End Date</label>
          <input type="date" class="form-input" name="endDate" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-input" name="description" rows="4" required></textarea>
        </div>
        <div class="form-actions">
          <button type="button" class="btn" onclick="closeAddPromoModal()">Cancel</button>
          <button type="submit" class="btn primary">Add Promotion</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Promotion Modal -->
  <div class="modal" id="editPromoModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Promotion</h3>
        <button class="modal-close" onclick="closeEditPromoModal()">&times;</button>
      </div>
      <form id="editPromoForm">
        <div class="form-group">
          <label class="form-label">Promotion Title</label>
          <input type="text" class="form-input" name="title" id="editTitle" required>
        </div>
        <div class="form-group">
          <label class="form-label">Discount (%)</label>
          <input type="number" class="form-input" name="discount" id="editDiscount" min="0" max="100" required>
        </div>
        <div class="form-group">
          <label class="form-label">Start Date</label>
          <input type="date" class="form-input" name="startDate" id="editStartDate" required>
        </div>
        <div class="form-group">
          <label class="form-label">End Date</label>
          <input type="date" class="form-input" name="endDate" id="editEndDate" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-input" name="description" id="editDescription" rows="4" required></textarea>
        </div>
        <div class="form-actions">
          <button type="button" class="btn" onclick="closeEditPromoModal()">Cancel</button>
          <button type="submit" class="btn primary">Update Promotion</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Promotion Management System
    class PromoManager {
      constructor() {
        this.promos = this.loadPromos();
        this.currentEditingId = null;
        this.init();
      }

      init() {
        this.renderPromos();
        this.setupEventListeners();
        this.updateKPIs();
      }

      loadPromos() {
        const promos = localStorage.getItem('vsv_promos');
        return promos ? JSON.parse(promos) : this.getDefaultPromos();
      }

      savePromos() {
        localStorage.setItem('vsv_promos', JSON.stringify(this.promos));
      }

      getDefaultPromos() {
        return [
          {
            id: 1,
            title: 'Diwali Dhamaka',
            description: 'Flat 25% off all products',
            discount: 25,
            startDate: '2024-10-20',
            endDate: '2024-10-30',
            status: 'active'
          },
          {
            id: 2,
            title: 'Weekend Offer',
            description: 'Buy 1 Get 1 Free',
            discount: 50,
            startDate: '2024-09-02',
            endDate: '2024-09-04',
            status: 'active'
          },
          {
            id: 3,
            title: 'Festive Combo',
            description: 'Extra â‚¹1000 off on orders above â‚¹5000',
            discount: 1000,
            startDate: '2024-09-10',
            endDate: '2024-09-20',
            status: 'active'
          },
          {
            id: 4,
            title: 'Flash Sale',
            description: '50% off on electronics',
            discount: 50,
            startDate: '2024-08-30',
            endDate: '2024-09-01',
            status: 'active'
          },
          {
            id: 5,
            title: 'Back to School',
            description: '20% off on stationery',
            discount: 20,
            startDate: '2024-08-15',
            endDate: '2024-08-31',
            status: 'active'
          }
        ];
      }

      setupEventListeners() {
        // Search
        const searchInput = document.getElementById('promoSearch');
        searchInput.addEventListener('input', (e) => {
          this.filterPromos(e.target.value);
        });

        // Filters
        const statusFilter = document.getElementById('statusFilter');
        const sortFilter = document.getElementById('sortFilter');

        statusFilter.addEventListener('change', () => this.applyFilters());
        sortFilter.addEventListener('change', () => this.applyFilters());

        // Add promo form
        const addForm = document.getElementById('addPromoForm');
        addForm.addEventListener('submit', (e) => {
          e.preventDefault();
          this.addPromo(new FormData(e.target));
          closeAddPromoModal();
          e.target.reset();
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
          document.documentElement.classList.toggle('light');
          const icon = themeToggle.querySelector('i');
          icon.className = document.documentElement.classList.contains('light') ? 'fa-solid fa-sun' : 'fa-solid fa-moon';
        });

        // Nav toggle for mobile
        const navToggle = document.getElementById('navToggle');
        const sidebar = document.getElementById('sidebar');
        navToggle.addEventListener('click', () => {
          sidebar.classList.toggle('open');
          document.body.classList.toggle('nav-open');
        });

        // Edit promo form
        const editForm = document.getElementById('editPromoForm');
        editForm.addEventListener('submit', (e) => {
          e.preventDefault();
          this.updatePromo(new FormData(e.target));
          this.closeEditPromoModal();
          e.target.reset();
        });
      }

      addPromo(formData) {
        const promo = {
          id: Date.now(),
          title: formData.get('title'),
          description: formData.get('description'),
          discount: parseInt(formData.get('discount')),
          startDate: formData.get('startDate'),
          endDate: formData.get('endDate'),
          status: 'active'
        };

        this.promos.unshift(promo);
        this.savePromos();
        this.renderPromos();
        this.updateKPIs();
      }

      deletePromo(id) {
        if (confirm('Are you sure you want to delete this promotion?')) {
          this.promos = this.promos.filter(p => p.id !== id);
          this.savePromos();
          this.renderPromos();
          this.updateKPIs();
        }
      }

      editPromo(id) {
        const promo = this.promos.find(p => p.id === id);
        if (promo) {
          this.currentEditingId = id;
          this.openEditPromoModal(promo);
        }
      }

      openEditPromoModal(promo) {
        document.getElementById('editTitle').value = promo.title;
        document.getElementById('editDiscount').value = promo.discount;
        document.getElementById('editStartDate').value = promo.startDate;
        document.getElementById('editEndDate').value = promo.endDate;
        document.getElementById('editDescription').value = promo.description;
        document.getElementById('editPromoModal').style.display = 'block';
      }

      closeEditPromoModal() {
        document.getElementById('editPromoModal').style.display = 'none';
        this.currentEditingId = null;
      }

      updatePromo(formData) {
        const promoIndex = this.promos.findIndex(p => p.id === this.currentEditingId);
        if (promoIndex !== -1) {
          this.promos[promoIndex] = {
            ...this.promos[promoIndex],
            title: formData.get('title'),
            description: formData.get('description'),
            discount: parseInt(formData.get('discount')),
            startDate: formData.get('startDate'),
            endDate: formData.get('endDate')
          };
          this.savePromos();
          this.renderPromos();
          this.updateKPIs();
        }
      }

      filterPromos(searchTerm) {
        const filtered = this.promos.filter(promo =>
          promo.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
          promo.description.toLowerCase().includes(searchTerm.toLowerCase())
        );
        this.renderPromoList(filtered);
      }

      applyFilters() {
        const statusFilter = document.getElementById('statusFilter').value;
        const sortFilter = document.getElementById('sortFilter').value;

        let filtered = this.promos;

        if (statusFilter !== 'all') {
          filtered = filtered.filter(p => p.status === statusFilter);
        }

        if (sortFilter === 'name') {
          filtered.sort((a, b) => a.title.localeCompare(b.title));
        } else if (sortFilter === 'date') {
          filtered.sort((a, b) => new Date(b.startDate) - new Date(a.startDate));
        } else if (sortFilter === 'discount') {
          filtered.sort((a, b) => b.discount - a.discount);
        }

        this.renderPromoList(filtered);
      }

      renderPromos() {
        this.renderPromoList(this.promos);
      }

      renderPromoList(promos) {
        const activeContainer = document.querySelector('.promo-grid');
        const pastContainer = document.querySelector('.promo-grid:last-of-type');

        // Clear existing
        activeContainer.innerHTML = '';
        pastContainer.innerHTML = '';

        const now = new Date();
        const activePromos = promos.filter(p => p.status === 'active' && new Date(p.endDate) >= now);
        const pastPromos = promos.filter(p => p.status !== 'active' || new Date(p.endDate) < now);

        activePromos.forEach(promo => {
          const card = this.createPromoCard(promo);
          activeContainer.appendChild(card);
        });

        pastPromos.forEach(promo => {
          const card = this.createPromoCard(promo, true);
          pastContainer.appendChild(card);
        });
      }

      createPromoCard(promo, isPast = false) {
        const card = document.createElement('div');
        card.className = `promo-card ${isPast ? 'past-promo' : ''}`;

        const status = isPast ? 'Ended' : 'Active';
        const badgeClass = isPast ? 'badge-past' : 'badge-active';

        card.innerHTML = `
          <h3>${promo.title} <span class="badge ${badgeClass}">${status}</span></h3>
          <p>${promo.description}</p>
          <p>Valid: ${this.formatDate(promo.startDate)} - ${this.formatDate(promo.endDate)}</p>
          <button class="btn-edit" onclick="promoManager.editPromo(${promo.id})">Edit</button>
          <button class="btn-delete" onclick="promoManager.deletePromo(${promo.id})">Delete</button>
        `;

        return card;
      }

      formatDate(dateStr) {
        return new Date(dateStr).toLocaleDateString();
      }

      updateKPIs() {
        const activeCount = this.promos.filter(p => p.status === 'active').length;
        const totalDiscount = this.promos.reduce((sum, p) => sum + (p.discount || 0), 0);

        document.getElementById('activePromos').textContent = activeCount;
        document.getElementById('totalDiscount').textContent = `â‚¹${totalDiscount.toLocaleString()}`;
      }
    }

    // Global functions for onclick
    function openAddPromoModal() {
      document.getElementById('addPromoModal').style.display = 'block';
    }

    function closeAddPromoModal() {
      document.getElementById('addPromoModal').style.display = 'none';
    }

    function openEditModal(title) {
      alert(`Edit modal for: ${title}`);
    }

    function closeEditPromoModal() {
      promoManager.closeEditPromoModal();
    }

    function confirmDelete(title) {
      return confirm(`Delete promotion: ${title}?`);
    }

    // Initialize
    const promoManager = new PromoManager();
  </script>
</body>
</html>
